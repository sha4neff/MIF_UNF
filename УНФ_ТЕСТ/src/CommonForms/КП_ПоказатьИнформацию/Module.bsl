
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Макет=ПолучитьОбщийМакет("КП_ДополнительнаяИнформация");
	
	Параметры.Свойство("НазваниеОбласти", НазваниеОбласти);
	Параметры.Свойство("АвтоматическиЗакрыватьЧерезМинут", АвтоматическиЗакрыватьЧерезМинут);
	
	Если НЕ ЗначениеЗаполнено(НазваниеОбласти) Тогда
		Отказ=Истина;
		ОбщегоНазначенияКлиентСервер.СообщитьПользователю(НСтр("ru='Не указана область макета для вывода.';en='Not specified layout area for the output.'"));
		Возврат;
	КонецЕсли;
	
	Параметры.Свойство("НазваниеЗаголовка", НазваниеЗаголовка);
	
	Если НЕ ПустаяСтрока(НазваниеЗаголовка) Тогда
		ЭтаФорма.Заголовок=НазваниеЗаголовка;
	КонецЕсли;
	
	ОбластьДляВывода=Макет.ПолучитьОбласть(НазваниеОбласти);
	
	ТабличныйДокументИнформации.Вывести(ОбластьДляВывода);
	
	Если НазваниеОбласти="СрокДемоБазыИстек" Тогда
		Элементы.ТабличныйДокументИнформации.Редактирование=Истина;
		Элементы.ГруппаНиз.Видимость=Истина;		
		
	ИначеЕсли НазваниеОбласти="ДемоБазаПредупреждение" Тогда
		Элементы.ТабличныйДокументИнформации.Редактирование=Истина;
		Элементы.ГруппаНиз.Видимость=Истина;		
		
		Если Параметры.Свойство("ДатаИстеченияСрока") Тогда
			ОбластьДаты=ТабличныйДокументИнформации.Область("ДатаИстеченияСрока");
		
			Если ЗначениеЗаполнено(ОбластьДаты) Тогда
				ОбластьДаты.Текст=Формат(Параметры.ДатаИстеченияСрока, "ДЛФ=DD");
			КонецЕсли;
			
		Конецесли;
		
	ИначеЕсли НазваниеОбласти="БетаВерсияПредупреждение" Тогда
		Элементы.ТабличныйДокументИнформации.Редактирование=Истина;
		Элементы.ГруппаНиз.Видимость=Истина;		
		
		Если Параметры.Свойство("ДатаИстеченияСрока") Тогда
			ОбластьДаты=ТабличныйДокументИнформации.Область("ДатаИстеченияСрокаБетаВерсии");
		
			Если ЗначениеЗаполнено(ОбластьДаты) Тогда
				ОбластьДаты.Текст=Формат(Параметры.ДатаИстеченияСрока, "ДЛФ=DD");
			КонецЕсли;
			
		Конецесли;
		
	Иначе
		
		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	Если АвтоматическиЗакрыватьЧерезМинут>0 Тогда
		ПодключитьОбработчикОжидания("ОбработчикЗакрытияСистемы", АвтоматическиЗакрыватьЧерезМинут*60, Истина);
		
	КонецЕсли;
	
	Если НазваниеОбласти="НастройкаСтатистикиНавигатораВыданныхИПолученныхЗадач" ИЛИ НазваниеОбласти="НастройкаСтатистикиНавигатораПолученныхЗадач" Тогда
		ЭтаФорма.Высота=25;
	КонецЕсли;

КонецПроцедуры

&НаКлиенте
Процедура ТабличныйДокументИнформацииВыбор(Элемент, Область, СтандартнаяОбработка)
			
	Если Область.Имя = "НастройкаНачальнойСтраницы1" ИЛИ Область.Имя = "НастройкаНачальнойСтраницы2" Тогда
		ПутьКСтранице="https://xn--90afdtkhdeabaxvge.net/other/rabochii_stol.html";
		КП_ОбщееКлиент.ОткрытьИнтернетАдрес(ПутьКСтранице);
								
	КонецЕсли;

КонецПроцедуры

&НаКлиенте
Процедура ДекорацияСайтРазработчикаURLНажатие(Элемент)
	ЗапуститьПриложение("https://xn--90afdtkhdeabaxvge.net?from=sed");

КонецПроцедуры

&НаКлиенте
Процедура НапечататьИнформацию(Команда)
	
	#Если ТонкийКлиент ИЛИ ВебКлиент Тогда
	Состояние(НСтр("ru='Открыть диалог выбора принтеров можно только из толстого клиента.';en='Open a printer dialog is possible only in thick client mode.'"));
	ТабличныйДокументИнформации.Напечатать(РежимИспользованияДиалогаПечати.НеИспользовать);
	Возврат;
	#Иначе
	ТабличныйДокументИнформации.Напечатать(РежимИспользованияДиалогаПечати.Использовать);
	#КонецЕсли
	
КонецПроцедуры

&НаКлиенте
Процедура СохранитьИнформацию(Команда)
	
	Диалог=Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Сохранение);
	
	Диалог.Фильтр="MS Excel (*.xls)|*.xls";
	Диалог.Расширение="xls";
	Диалог.ПолноеИмяФайла="demo-base.xls";

	Если Диалог.Выбрать() Тогда
		ИмяФайла=Диалог.ПолноеИмяФайла;
		ТабличныйДокументИнформации.Записать(ИмяФайла, ТипФайлаТабличногоДокумента.XLS);
		Состояние(НСтр("ru='Файл ';")+ИмяФайла+НСтр("ru=' сохранен.';"));
	КонецЕсли;

КонецПроцедуры

&НаКлиенте
Процедура ОбработчикЗакрытияСистемы() Экспорт
	ЭтаФорма.Закрыть();	
КонецПроцедуры

