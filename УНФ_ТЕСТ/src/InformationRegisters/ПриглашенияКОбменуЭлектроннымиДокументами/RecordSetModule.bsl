
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ОбработчикиСобытий

Процедура ПриЗаписи(Отказ, Замещение)
	
	Если ОбменДанными.Загрузка Тогда
		Возврат;
	КонецЕсли;
	
	Для Каждого Запись Из ЭтотОбъект Цикл
		
		Если Запись.Статус = Перечисления.СтатусыПриглашений.Отклонено Тогда
			ЗаписьСостоянияКонтрагента = РегистрыСведений.СостоянияКонтрагентовБЭД.СоздатьМенеджерЗаписи();
			ЗаписьСостоянияКонтрагента.Контрагент = Запись.Контрагент;
			
			ЗаписьСостоянияКонтрагента.Прочитать();
			
			Если ЗаписьСостоянияКонтрагента.Выбран() Тогда 
				ЗаписьСостоянияКонтрагента.Состояние = Перечисления.СостоянияКонтрагентаБЭД.Подключен;
				ЗаписьСостоянияКонтрагента.Записать();
			КонецЕсли;
			
		КонецЕсли;
	
	КонецЦикла;
	
КонецПроцедуры

#КонецОбласти

#Иначе
	ВызватьИсключение НСтр("ru = 'Недопустимый вызов объекта на клиенте.'");
#КонецЕсли